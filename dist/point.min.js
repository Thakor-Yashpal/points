"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vector(t,i){this.x=t||0,this.y=i||0}function GravityPoint(t,i,e,r){Vector.call(this,t,i),this.radius=e,this.currentRadius=.5*e,this._targets={particles:r.particles||[],gravities:r.gravities||[]},this._speed=new Vector}function Particle(t,i,e){Vector.call(this,t,i),this.radius=e,this._latest=new Vector,this._speed=new Vector}window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},Vector.add=function(t,i){return new Vector(t.x+i.x,t.y+i.y)},Vector.sub=function(t,i){return new Vector(t.x-i.x,t.y-i.y)},Vector.scale=function(t,i){return t.clone().scale(i)},Vector.random=function(){return new Vector(2*Math.random()-1,2*Math.random()-1)},Vector.prototype={set:function(t,i){return"object"===_typeof(t)&&(i=t.y,t=t.x),this.x=t||0,this.y=i||0,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},scale:function(t){return this.x*=t,this.y*=t,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSq:function(){return this.x*this.x+this.y*this.y},normalize:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return t&&(this.x/=t,this.y/=t),this},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){var i=t.x-this.x,e=t.y-this.y;return Math.atan2(e,i)},distanceTo:function(t){var i=t.x-this.x,e=t.y-this.y;return Math.sqrt(i*i+e*e)},distanceToSq:function(t){var i=t.x-this.x,e=t.y-this.y;return i*i+e*e},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},clone:function(){return new Vector(this.x,this.y)},toString:function(){return"(x:"+this.x+", y:"+this.y+")"}},GravityPoint.RADIUS_LIMIT=65,GravityPoint.interferenceToPoint=!0,GravityPoint.prototype=function(t){var i,e=new Vector(0,0);for(i in t)e[i]=t[i];return e}({gravity:.05,isMouseOver:!1,dragging:!1,destroyed:!1,_easeRadius:0,_dragDistance:null,_collapsing:!1,hitTest:function(t){return this.distanceTo(t)<this.radius},startDrag:function(t){this._dragDistance=Vector.sub(t,this),this.dragging=!0},drag:function(t){this.x=t.x-this._dragDistance.x,this.y=t.y-this._dragDistance.y},endDrag:function(){this._dragDistance=null,this.dragging=!1},addSpeed:function(t){this._speed=this._speed.add(t)},collapse:function(){this.currentRadius*=1.75,this._collapsing=!0},render:function(t){if(!this.destroyed){var i,e,r=this._targets.particles;for(i=0,e=r.length;i<e;i++)r[i].addSpeed(Vector.sub(this,r[i]).normalize().scale(this.gravity));if(this._easeRadius=.95*(this._easeRadius+.07*(this.radius-this.currentRadius)),this.currentRadius+=this._easeRadius,this.currentRadius<0&&(this.currentRadius=0),this._collapsing)return this.radius*=.75,this.currentRadius<1&&(this.destroyed=!0),void this._draw(t);var n,s,a,o=this._targets.gravities,h=this.radius*this.radius*Math.PI;for(i=0,e=o.length;i<e;i++)(n=o[i])===this||n.destroyed||((this.currentRadius>=n.radius||this.dragging)&&this.distanceTo(n)<.85*(this.currentRadius+n.radius)&&(n.destroyed=!0,this.gravity+=n.gravity,s=Vector.sub(n,this).scale(n.radius/this.radius*.5),this.addSpeed(s),a=n.radius*n.radius*Math.PI,this.currentRadius=Math.sqrt((h+3*a)/Math.PI),this.radius=Math.sqrt((h+a)/Math.PI)),n.addSpeed(Vector.sub(this,n).normalize().scale(this.gravity)));GravityPoint.interferenceToPoint&&!this.dragging&&this.add(this._speed),this._speed=new Vector,this.currentRadius>GravityPoint.RADIUS_LIMIT&&this.collapse(),this._draw(t)}},_draw:function(t){var i,e;t.save(),(i=t.createRadialGradient(this.x,this.y,this.radius,this.x,this.y,5*this.radius)).addColorStop(0,"rgba(0, 0, 0, 0.1)"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),t.beginPath(),t.arc(this.x,this.y,5*this.radius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),e=Math.random()*this.currentRadius*.7+.3*this.currentRadius,(i=t.createRadialGradient(this.x,this.y,e,this.x,this.y,this.currentRadius)).addColorStop(0,"rgba(0, 0, 0, 1)"),i.addColorStop(1,Math.random()<.2?"rgba(255, 196, 0, 0.15)":"rgba(103, 181, 191, 0.75)"),t.beginPath(),t.arc(this.x,this.y,this.currentRadius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.restore()}}),Particle.prototype=function(t){var i,e=new Vector(0,0);for(i in t)e[i]=t[i];return e}({addSpeed:function(t){this._speed.add(t)},update:function(){12<this._speed.length()&&this._speed.normalize().scale(12),this._latest.set(this),this.add(this._speed)}}),function(){var n,s,a,o,h,d,u,t,i,c=new Vector,l=[],f=[];function e(t){h=n.width=window.innerWidth,d=n.height=window.innerHeight,a.width=h,a.height=d,s=n.getContext("2d"),o=a.getContext("2d");var i=.5*n.width,e=.5*n.height;(u=s.createRadialGradient(i,e,0,i,e,Math.sqrt(i*i+e*e))).addColorStop(0,"rgba(0, 0, 0, 0)"),u.addColorStop(1,"rgba(0, 0, 0, 0.35)")}function r(t){var i,e;for(i=0;i<t;i++)(e=new Particle(Math.floor(Math.random()*h-2)+1+1,Math.floor(Math.random()*d-2)+1+1,1)).addSpeed(Vector.random()),f.push(e)}i={particleNum:100},n=document.getElementById("c"),a=document.createElement("canvas"),window.addEventListener("resize",e,!1),e(),r(i.particleNum),n.addEventListener("mousemove",function(t){c.set(t.clientX,t.clientY);var i,e,r=!1;for(i=l.length-1;0<=i;i--)e=l[i],!r&&e.hitTest(c)||e.dragging?e.isMouseOver=r=!0:e.isMouseOver=!1;n.style.cursor=r?"pointer":"default"},!1),n.addEventListener("mousedown",function(t){for(var i=l.length-1;0<=i;i--)if(l[i].isMouseOver)return void l[i].startDrag(c);l.push(new GravityPoint(t.clientX,t.clientY,10,{particles:f,gravities:l}))},!1),n.addEventListener("mouseup",function(t){for(var i=0,e=l.length;i<e;i++)if(l[i].dragging){l[i].endDrag();break}},!1),n.addEventListener("dblclick",function(t){for(var i=l.length-1;0<=i;i--)if(l[i].isMouseOver){l[i].collapse();break}},!1),(t=new dat.GUI).add(i,"particleNum",0,500).step(1).name("Particle Num").onChange(function(){var t=(0|i.particleNum)-f.length;0<t?r(t):t<0&&function(t){f.length<t&&(t=f.length);for(var i=0;i<t;i++)f.pop()}(-t)}),t.add(GravityPoint,"interferenceToPoint").name("Interference Between Point"),t.close();!function t(){var i,e,r,n;for(s.save(),s.fillStyle="rgba(11, 51, 56, 1)",s.fillRect(0,0,h,d),s.fillStyle=u,s.fillRect(0,0,h,d),s.restore(),i=0,e=l.length;i<e;i++)(r=l[i]).dragging&&r.drag(c),r.render(s),r.destroyed&&(l.splice(i,1),e--,i--);for(o.save(),o.globalCompositeOperation="destination-out",o.globalAlpha=.35,o.fillRect(0,0,h,d),o.restore(),e=f.length,o.save(),o.fillStyle=o.strokeStyle="#fff",o.lineCap=o.lineJoin="round",o.lineWidth=2,o.beginPath(),i=0;i<e;i++)(n=f[i]).update(),o.moveTo(n.x,n.y),o.lineTo(n._latest.x,n._latest.y);for(o.stroke(),o.beginPath(),i=0;i<e;i++)n=f[i],o.moveTo(n.x,n.y),o.arc(n.x,n.y,n.radius,0,2*Math.PI,!1);o.fill(),o.restore(),s.drawImage(a,0,0),requestAnimationFrame(t)}()}();
//# sourceMappingURL=point.min.js.map
